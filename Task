<?php
session_start();
include('server.php');

if (!isset($_SESSION["username"])) {
    header("Location: index.php");
    exit();
}


$username = trim($_SESSION["username"]);
$sql="SELECT * FROM signup WHERE username='$username'";
$result=mysqli_query($conn,$sql);
if($result){
    $row=$result->fetch_assoc();
    $status=$row['status'];
    if($status !='active')
    {
        header("location:index.php");
    }
}
 
 
              $start=0;
             $rows_per_page=5;

         $records =$conn->query("SELECT * FROM meme");
         $nr_of_rows= $records->num_rows;
         $pages=ceil($nr_of_rows/$rows_per_page);

         if(isset($_GET['page-nr']))
         {
              $page = $_GET['page-nr'] - 1;
              $start = $page * $rows_per_page;
         }
         else{
              $page=0;
         }



?>



<!DOCTYPE html>
<html lang="en">
<head>
       <meta charset="utf-8">
       <meta name="viewport" content="width=device-width, initial-scale=1.0">
       <title>Posted Blogs</title>
       <!-- Open sas Font-->
       <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
       <!--Material icons-->
       <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined"
      rel="stylesheet">
      <!--Bootstrap icons-->
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
       <!-- Custom css -->
       <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/alertify.min.css"/>
       <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/bootstrap.min.css"/>
     <!-- ICONS -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <!-- STYLESHEET -->
    <script>
    if ( window.history.replaceState ) {
        window.history.replaceState( null, null, window.location.href );
    }
</script>
       <!-- Custom css -->
        
       <link rel="stylesheet" href="css/style.css">
</head>
<style>
      
       
  .blogs{
       display:block;
       padding: 10px;
       background: #fff;
  }
  .blogs h2{
       color:darkblue;
       font-weight: 800;
       font-size: 16px;
       text-align: center;
  }
  .content{
       padding: 20px;
  }


    .table{
              border: none;
              width: 100%;
              
           
              
       }
       th{
              background:blueviolet;
              color: whitesmoke;
              font-size: 14px;
       }
       td{
              font-size: small;
              border: #f2f2f2 solid 7px;
            
       }
         th td{
        padding: 12px 15px;
        text-align: left;
       }
       table tr td:nth-child(3){
             text-align:left;
            background: palegreen;
             color:#333;
            font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
             padding: 12px;
             font-weight: 700;
             font-size: 17px;

       }
     .error{
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: orangered;
        padding: 50px;
     }
     .error h2{
        color: black;
        font-size: 16px;
     }
      
       @media(max-width: 600px)
       {
        body{
            display:block;
        }
         
         .table-container{
        width: 100%;
        /*max-width: 900px;*/
        margin: 0 auto;
        padding: 5px;
       
    }
    .table-wrapper{
        overflow-x: hidden;
        overflow-y: auto;
    }
    .styled-table{
    width: 100%;
    /*min-width: 800px;*/
    
    }
       
       }
      
</style>

<body >
       <div class="grid-container">
<?php
include'header.php';
include'side.php';

?>
<!--Main-->
<!--Main-->
<main class="main-container" >
<?php
if($pages==0)
{
    ?>
    <div class="error">
        <h2>Oops! <?php echo $username ?> No Posted Blogs at the Moment</h2>
    </div>
    <?php
}
?>
<?php 
if($pages!=0)
{
?>





<div class="blogs">
              <h2>Welcome to Superqash Blog platform. Browse more Blog Templates here and use them as hyping materials to Earn more in Network Marketing.</h2>
       <div class="content">
              <section class="table-container">

       <div class="table-wrapper">
<table class="styled-table">
       
                     <tr>
                            <th>Id</th>
                            <th>Blogger</th>
                            <th>Blog Posted</th>
                           
                     </tr>
                     
          
              <?php

      
              $id=$start+1;
              $sql= "SELECT * FROM meme LIMIT $start,$rows_per_page";
              $result = mysqli_query($conn,$sql);
              if($result)
              {
                     while($row = $result->fetch_assoc())
                     {       
                              $user = $row['username'];
                             $meme = $row['blog'];
                            


                              echo "<tr>";
                              echo "<td>$id</td>";
                              echo "<td>$user</td>";
                              echo "<td>$meme</td>";
                              echo "</tr>";
                   $id++;
                     }
                   
                     
                   
              } 
              ?>
                  </table>
                   <div class="page-info">
           <?php $current=$page+1;
           ?>
            Showing <?php echo $current."of".$pages ?> pages
        </div>
        <div class="pagination" style="margin-bottom: 20px;">
            <a href="?page-nr=1">First</a>
            <?php
             if(isset($_GET['page-nr']) && $_GET['page-nr']>1){
                ?>
               <a href="?page-nr=<?php echo $_GET['page-nr']-1?>">Previous</a>
               <?php
             }
             else{
                ?>
                 <a>Previous</a>
                <?php
               
             }
            ?>
           <?php
           if(!isset($_GET['page-nr'])){
            ?>
            <a href="?page-nr=2">Next</a>
            <?php
           }
           else{
            if($_GET['page-nr'] >= $pages){
                ?>
                <a>Next</a>
                <?php
            }
            else{
                ?>
                <a href="?page-nr=<?php echo $_GET['page-nr'] + 1 ?> ">Next</a>
                <?php
            }
           }
           ?>
            <a href="?page-nr=<?php echo $pages ?>">Last</a>
        </div>

       </div>
              </section>
       </div>
       </div>
       </form>
       
</div>
</div>
</div>
<?php
}
?>

</main>
<!--End main-->
</div>

      <?php include'footer.php';
?>

<!--Custom Js -->

</body>
<script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.js"
      integrity="sha512-8Z5++K1rB3U+USaLKG6oO8uWWBhdYsM3hmdirnOEWp8h2B1aOikj5zBzlXs8QOrvY9OxEnD2QDkbSKKpfqcIWw=="
      crossorigin="anonymous"
    ></script>
    <script src="js/script.js"></script>
</html>
